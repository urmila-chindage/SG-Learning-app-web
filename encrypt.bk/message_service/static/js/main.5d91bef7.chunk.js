(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t){e.exports="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QMraHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MSA2NC4xNDA5NDksIDIwMTAvMTIvMDctMTA6NTc6MDEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUuMSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkE4RTMyQ0RFNzAxMTExRTY4NDcyQ0ZCNEQ2MjIwNDhEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkE4RTMyQ0RGNzAxMTExRTY4NDcyQ0ZCNEQ2MjIwNDhEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QThFMzJDREM3MDExMTFFNjg0NzJDRkI0RDYyMjA0OEQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QThFMzJDREQ3MDExMTFFNjg0NzJDRkI0RDYyMjA0OEQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAABAQEBAQEBAQEBAQEBAQEBAQEB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"},178:function(e,t,r){e.exports=r.p+"static/media/searchicon.381a451d.svg"},181:function(e,t,r){e.exports=r(419)},279:function(e,t,r){},280:function(e,t,r){},281:function(e,t,r){},282:function(e,t,r){},416:function(e,t){},419:function(e,t,r){"use strict";r.r(t);r(182),r(420);var a=r(0),s=r.n(a),n=r(65),c=r.n(n),o=(r(279),r(35)),i=r(36),l=r(38),u=r(37),p=r(39),d=(r(280),r(281),r(282),r(6)),A=r.n(d),m=r(17),h=r(178),g=r.n(h),f=r(24),E=r(23),v=r(50),b=window.location.href.replace(window.location.pathname,""),T={REACT_APP_API_URL:b+"/nservermessage/web/",REACT_APP_AUTH_URL:b+"/content/get_user_data",REACT_APP_SOCKET_URL:b,REACT_APP_SOCKET_PATH:"/nservermessage/socket/"},S=T.REACT_APP_AUTH_URL,I=T.REACT_APP_API_URL,y=100,w=20;function M(e){return Object(v.a)({},e)}function j(e,t){var r=new Date(e.datetime).getTime(),a=new Date(t.datetime).getTime();return r<a?1:r>a?-1:0}function B(e){return{dispatch:e,authenticate:function(){var t=Object(m.a)(A.a.mark(function t(){var r,a,s;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(S,{credentials:"include"});case 3:return r=t.sent,t.next=6,r.json();case 6:if((a=t.sent).error="string"===typeof a.error?"true"===a.error:a.error,a.error){t.next=12;break}return s={userId:parseInt(a.data.student.id),name:a.data.student.student_name,image:a.data.student.student_image},e({type:"SET_STATE",value:{token:a.data.token,currentUser:s,isAuthenticated:!0}}),t.abrupt("return",!0);case 12:return t.abrupt("return",!1);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,null,[[0,15]])}));return function(){return t.apply(this,arguments)}}(),getUsers:function(){var t=Object(m.a)(A.a.mark(function t(r,a){var s,n;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e({type:"SET_STATE",value:{loadingUserList:!0,users:[]}}),t.next=4,fetch("".concat(I,"users"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(a)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)});case 4:return s=t.sent,t.next=7,s.json();case 7:if(!((n=t.sent).success&&n.data.length>0)){t.next=11;break}return e({type:"SET_STATE",value:{users:n.data,loadingUserList:!1,userScroll:n.data.length%y===0}}),t.abrupt("return",!0);case 11:return e({type:"SET_STATE",value:{users:[],messages:[],messageScroll:!1,selectedUser:{name:""},loadingUserList:!1}}),t.abrupt("return",!1);case 15:return t.prev=15,t.t0=t.catch(0),e({type:"SET_STATE",value:{users:[],messages:[],messageScroll:!1,selectedUser:{name:""},loadingUserList:!1}}),t.abrupt("return",!1);case 19:case"end":return t.stop()}},t,null,[[0,15]])}));return function(e,r){return t.apply(this,arguments)}}(),getScrollUsers:function(){var t=Object(m.a)(A.a.mark(function t(r,a,s){var n,c;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e({type:"SET_STATE",value:{loadingUserList:!0}}),t.next=4,fetch("".concat(I,"users"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(s)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)});case 4:return n=t.sent,t.next=7,n.json();case 7:if(!(c=t.sent).success){t.next=15;break}if(!(c.data.length>0)){t.next=14;break}return e({type:"SET_STATE",value:{loadingUserList:!1,users:[].concat(Object(E.a)(a),Object(E.a)(c.data)),userScroll:c.data.length%y===0}}),t.abrupt("return",!0);case 14:e({type:"SET_STATE",value:{userScroll:!1}});case 15:return e({type:"SET_STATE",value:{loadingUserList:!1}}),t.abrupt("return",!1);case 19:return t.prev=19,t.t0=t.catch(0),e({type:"SET_STATE",value:{loadingUserList:!1}}),t.abrupt("return",!1);case 23:case"end":return t.stop()}},t,null,[[0,19]])}));return function(e,r,a){return t.apply(this,arguments)}}(),getMessages:function(){var t=Object(m.a)(A.a.mark(function t(r,a){var s,n;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e({type:"SET_STATE",value:{loadingMessageList:!0,messages:[],scrollToBottom:!0,messageScroll:!1}}),t.next=4,fetch("".concat(I,"messages"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(a)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)});case 4:return s=t.sent,t.next=7,s.json();case 7:if(!((n=t.sent).success&&n.data.length>0)){t.next=11;break}return e({type:"SET_STATE",value:{messages:n.data,loadingMessageList:!1,messageScroll:n.data.length%w===0}}),t.abrupt("return",!0);case 11:return e({type:"SET_STATE",value:{loadingMessageList:!1}}),t.abrupt("return",!1);case 15:return t.prev=15,t.t0=t.catch(0),e({type:"SET_STATE",value:{loadingMessageList:!1}}),t.abrupt("return",!1);case 19:case"end":return t.stop()}},t,null,[[0,15]])}));return function(e,r){return t.apply(this,arguments)}}(),getScrollMessages:function(){var t=Object(m.a)(A.a.mark(function t(r,a,s){var n,c;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e({type:"SET_STATE",value:{loadingMessageList:!0,scrollToBottom:!1}}),t.next=4,fetch("".concat(I,"messages"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(s)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)});case 4:return n=t.sent,t.next=7,n.json();case 7:if(!(c=t.sent).success){t.next=15;break}if(!(c.data.length>0)){t.next=14;break}return e({type:"SET_STATE",value:{loadingMessageList:!1,messages:[].concat(Object(E.a)(c.data),Object(E.a)(a)),messageScroll:c.data.length%w===0}}),t.abrupt("return",!0);case 14:e({type:"SET_STATE",value:{messageScroll:!1}});case 15:return e({type:"SET_STATE",value:{loadingMessageList:!1}}),t.abrupt("return",!1);case 19:return t.prev=19,t.t0=t.catch(0),e({type:"SET_STATE",value:{loadingMessageList:!1}}),t.abrupt("return",!1);case 23:case"end":return t.stop()}},t,null,[[0,19]])}));return function(e,r,a){return t.apply(this,arguments)}}(),updateUsers:function(t,r){var a=t.map(function(e){return e.classes=e.userId===r?"person active":"person",e});e({type:"SET_STATE",value:{users:a}})},updateUsersList:function(t,r,a){var s=Object(E.a)(t);if(r.length<y)for(var n=function(e){var t=r[e],a=s.findIndex(function(e){return e.userId===t.userId});a>-1?s[a]=Object(v.a)({},t):s=[t].concat(Object(E.a)(s))},c=0;c<r.length;c++)n(c);else s=Object(E.a)(r);s=(s=s.map(function(e){return e.classes=e.userId===a?"person active":"person",e})).sort(j),e({type:"SET_STATE",value:{users:s}})},setSelectedUser:function(t){return e({type:"SET_STATE",value:{selectedUser:t}})},setSocketIds:function(t){return e({type:"SET_STATE",value:{socketIds:t}})},sendMessage:function(t,r,a){var s=[].concat(Object(E.a)(t),[r]);e({type:"SET_STATE",value:{messages:s}}),fetch("".concat(I,"savemessage"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(a)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)})},clearMessageCount:function(e,t){fetch("".concat(I,"clearmessagecount"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(t)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(e)})},updateUserState:function(e,t){fetch("".concat(I,"updatestate"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(t)},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(e)})}}}var x=r(40),k=r(180),O=T.REACT_APP_SOCKET_URL,N=T.REACT_APP_SOCKET_PATH,C=r.n(k)()(O,{path:N}),D=function(e){C.emit("adduser",e)},L=r(102),Q=r.n(L);function R(e){e.target.src=Q.a}var U=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={search:"",users:[]},r.peopleRef=s.a.createRef(),r.submitTimeout=null,r.handleSubmit=function(e){e&&e.preventDefault(),r.fetchUsers()},r.handleChange=function(e){var t=e.target.value;r.setState({search:t?t.trim():""}),r.submitTimeout&&clearTimeout(r.submitTimeout),r.submitTimeout=setTimeout(function(){r.handleSubmit()},500)},r.loadMoreUsers=Object(m.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t={receiverId:r.props.currentUser.userId,search:""}).skip=r.props.users.length,t.search=r.state.search,e.next=5,r.props.getScrollUsers(t,r.props.users,r.props.token);case 5:r.props.updateUsers(r.props.users,r.props.selectedUser.userId);case 6:case"end":return e.stop()}},e)})),r.handleScroll=function(e){r.peopleRef.current.scrollTop+r.peopleRef.current.clientHeight>=r.peopleRef.current.scrollHeight&&r.props.userScroll&&!r.props.loadingUserList&&r.loadMoreUsers()},D(r.props.currentUser.userId),C.on("newsenders",function(e){e.length>0&&(r.props.updateUsersList(r.props.users,e,r.props.selectedUser.userId),r.handleClick(r.props.selectedUser.userId?r.props.selectedUser:r.props.users[0]))}),C.on("usersockets",function(e){e.length>0&&r.props.setSocketIds(e)}),r.props.clearMessageCount({userId:r.props.currentUser.userId},r.props.token),r}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleClick",value:function(e){this.props.getMessages({receiverId:this.props.currentUser.userId,senderId:e.userId},this.props.token),this.props.updateUsers(this.props.users,e.userId),e.count=0,this.props.setSelectedUser(e),this.props.updateUserState({userId:e.userId,receiverId:e.receiverId},this.props.token)}},{key:"fetchUsers",value:function(){var e=Object(m.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t={receiverId:this.props.currentUser.userId,search:""}).search=this.state.search,e.next=5,this.props.getUsers(t,this.props.token);case 5:e.sent&&this.handleClick(this.props.users[0]),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.fetchUsers(),window.$(".people-list").slimScroll({size:"10px",height:"100%"})}},{key:"userLoading",value:function(){if(this.props.loadingUserList||!this.props.loadingUserList&&0===this.props.users.length)return s.a.createElement("li",{className:"person","data-chat":"person1"},s.a.createElement("span",{className:"people-img"}),s.a.createElement("div",{className:"people-details"},this.props.loadingUserList&&s.a.createElement("span",null,"Loading ..."),!this.props.loadingUserList&&0===this.props.users.length&&s.a.createElement("span",null,"Not Found!")))}},{key:"render",value:function(){var e=this,t=this.props.users.map(function(t){var r=t.image.split("/"),a=r[r.length-1].split(".").length>1?t.image:"";return s.a.createElement("li",{key:t.userId,className:t.classes,onClick:function(){return e.handleClick(t)},"data-chat":"person1"},s.a.createElement("span",{className:"people-img"},s.a.createElement("img",{onError:R,src:a?a+"?_"+(Math.floor(1e3*Math.random())+1):Q.a,alt:""})),s.a.createElement("div",{className:"people-details"},t.count>0&&s.a.createElement("span",{className:"green-dot-new"},t.count),s.a.createElement("span",{className:"name"},t.name),s.a.createElement("span",{className:"time"},Object(x.format)(new Date(t.datetime),"MMM Do YY, hh:mm a")),s.a.createElement("span",{className:"preview"},t.message)))});return s.a.createElement("div",{className:"left"},s.a.createElement("div",{className:"top"},s.a.createElement("div",{className:"back-btn"}),s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",name:"search",autoComplete:"off",placeholder:"Search by Name",onChange:this.handleChange}),s.a.createElement("button",{className:"search"},s.a.createElement("img",{src:g.a,alt:"Search Icon"})))),s.a.createElement("div",{className:"people"},s.a.createElement("ul",{className:"people-list",ref:this.peopleRef,onScroll:this.handleScroll},t,this.userLoading())))}}]),t}(a.Component),P=Object(f.b)(M,B)(U),z=r(66),H=function(e){function t(e){var r;return Object(o.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={width:0,height:0},r.handleSubmit=function(e){e.preventDefault();var t=new FormData(e.target);t.get("content").trim().replace(/&nbsp;/g,"").replace(/<p>/g,"").replace(/<\/p>/g,"").trim()&&(r.props.sendMessage(r.props.messages,{datetime:(new Date).toISOString(),message:t.get("content"),receiverId:r.props.selectedUser.userId,senderId:r.props.currentUser.userId,senderName:r.props.currentUser.name,senderImage:r.props.currentUser.image,_id:Date.now()},r.props.token),window.$R("#content","source.setCode",""),r.scrollToBottom())},r.loadMoreMessages=Object(m.a)(A.a.mark(function e(){var t,a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={receiverId:r.props.currentUser.userId,senderId:r.props.selectedUser.userId,skip:r.props.messages.length},a=r.props.messages.length>0?r.props.messages[0]._id:"",e.next=5,r.props.getScrollMessages(t,r.props.messages,r.props.token);case 5:e.sent&&a&&document.getElementById(a).scrollIntoView({block:"center",inline:"nearest"}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,null,[[0,9]])})),r.handleScroll=function(e){r.props.messageScroll&&r.loadMoreMessages()},r.updateWindowDimensions=r.updateWindowDimensions.bind(Object(z.a)(r)),r.chatRef=s.a.createRef(),r}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),window.$R("#content",{placeholder:"Type here...",source:!1,style:!1,linkTarget:"_blank",height:"100%",callbacks:{drop:function(e){return!1},inserted:function(e){for(var t=0;t<e.length;t++){var r=e[t];"FIGURE"===r.nodeName&&r.parentNode.removeChild(r)}}}})}},{key:"scrollToBottom",value:function(){var e=this;setTimeout(function(){var t=e.props.messages.length;t>0&&document.getElementById(e.props.messages[t-1]._id).scrollIntoView({block:"end",inline:"nearest"})},500)}},{key:"componentDidUpdate",value:function(){this.props.scrollToBottom&&this.scrollToBottom()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"messageLoading",value:function(){var e="Load More";if(this.props.loadingMessageList)e="Loading ...";else if(this.props.loadingMessageList||0!==this.props.messages.length){if(!this.props.messageScroll)return;e="Load More"}else e="No messages found!";return s.a.createElement("div",{className:"message loadmessage"},s.a.createElement("button",{type:"button",disabled:this.props.loadingMessageList||!this.props.messageScroll,className:"load-btn",onClick:this.handleScroll},e))}},{key:"render",value:function(){var e={height:.65*this.state.height},t=null,r=this.props.currentUser,a=document.querySelector(".redactor-styles");a&&(a.style.height="".concat(.35*this.state.height-110,"px"));var n=this.props.socketIds.indexOf(this.props.selectedUser.userId)>-1,c=n?"green-dot":"yellow-dot",o=n?"Online":"Offline",i=this.props.messages.map(function(e){var a=e.senderId===r.userId?["message-data pull-right","bubble me"]:["message-data","bubble you"],n=Object(x.differenceInDays)(new Date(e.datetime),new Date),c="";return t!==n&&(n>0||n<0?c=s.a.createElement("div",{className:"conversation-start"},s.a.createElement("span",null,Object(x.format)(new Date(e.datetime),"MMM Do, YYYY"))):0===n&&(c=s.a.createElement("div",{className:"conversation-start"},s.a.createElement("span",null,"Today")))),t=n,s.a.createElement("div",{id:e._id,key:e._id},c,s.a.createElement("div",{className:"message"},s.a.createElement("div",{className:a[0]},s.a.createElement("span",{className:"message-data-name"},e.senderName),s.a.createElement("span",{className:"message-data-time"},Object(x.format)(new Date(e.datetime),"hh:mm a"))),s.a.createElement("div",{className:a[1],dangerouslySetInnerHTML:{__html:e.message}})))});return s.a.createElement("div",{className:"right"},s.a.createElement("span",{className:"menu-icon"}),s.a.createElement("div",{className:"chat-container"},s.a.createElement("div",{className:"top"},this.props.selectedUser.name&&s.a.createElement("span",null," ",s.a.createElement("span",{className:c,title:o})," ",s.a.createElement("span",{className:"name"},this.props.selectedUser.name))),s.a.createElement("div",{className:"chat active-chat",ref:this.chatRef,style:e,"data-chat":"person2"},this.messageLoading(),i)),s.a.createElement("form",{id:"messaging_form",onSubmit:this.handleSubmit},s.a.createElement("div",{className:"write",id:"toolbar-target"},s.a.createElement("textarea",{id:"content",name:"content"}),s.a.createElement("div",{id:"file-target"}),s.a.createElement("button",{className:"post-btn",disabled:0===this.props.users.length}," ",s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 1792 1792",width:"20"},s.a.createElement("path",{fill:"#fff",d:"M1764 11q33 24 27 64l-256 1536q-5 29-32 45-14 8-31 8-11 0-24-5l-453-185-242 295q-18 23-49 23-13 0-22-4-19-7-30.5-23.5t-11.5-36.5v-349l864-1059-1069 925-395-162q-37-14-40-55-2-40 32-59l1664-960q15-9 32-9 20 0 36 11z"})),"Send"))))}}]),t}(a.Component),Y=Object(f.b)(M,B)(H),X=function(e){function t(e){var r;return Object(o.a)(this,t),r=Object(l.a)(this,Object(u.a)(t).call(this,e)),C.on("connect",function(){console.log("Socket connection: ".concat(C.connected)),r.props.currentUser.userId&&D(r.props.currentUser.userId)}),r.props.authenticate(),r}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.isAuthenticated?s.a.createElement("div",{className:"container"},s.a.createElement(P,null),s.a.createElement(Y,null)):s.a.createElement("div",{className:"container"},s.a.createElement("p",{className:"loader"},"Loading ..."));return s.a.createElement("div",{className:"wrapper messaging_wrapper"},e)}}]),t}(a.Component),W=Object(f.b)(M,B)(X);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=function(e,t){switch(t.type){case"SET_STATE":return Object(v.a)({},e,t.value);default:return e}},V=r(67);window.BUILD_DATE="2019_09_12";var G=Object(V.b)(J,{users:[],messages:[],currentUser:{userId:!1},selectedUser:{name:""},token:"",isAuthenticated:!1,loadingUserList:!1,loadingMessageList:!1,messageScroll:!1,userScroll:!0,scrollToBottom:!0,socketIds:[]});c.a.render(s.a.createElement(f.a,{store:G},s.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[181,1,2]]]);
//# sourceMappingURL=main.5d91bef7.chunk.js.map